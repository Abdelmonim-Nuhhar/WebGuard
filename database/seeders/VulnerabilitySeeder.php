<?php 

 

namespace Database\Seeders; 

 

use Illuminate\Database\Console\Seeds\WithoutModelEvents; 

use Illuminate\Database\Seeder; 

use App\Models\Vulnerability; 

 

class VulnerabilitySeeder extends Seeder 

{ 

    /** 

     * Run the database seeds. 

     */ 

    public function run(): void 

    { 

        $vulnerabilities = [ 

            [ 

                'name' => 'SQL Injection', 

                'description' => 'A type of attack that can manipulate a database by injecting malicious SQL code.', 

                'severity' => 'High', 

                'is_fixed' => false, 

                'mitigation' => 'Use parameterized queries and prepared statements to prevent SQL injection.', 

                'created_at' => now(), 

                'updated_at' => now(), 

            ], 

            [ 

                'name' => 'Cross-Site Scripting (XSS)', 

                'description' => 'A type of security vulnerability that allows attackers to inject malicious scripts into web pages viewed by other users.', 

                'severity' => 'Medium', 

                'is_fixed' => true, 

                'mitigation' => 'Validate and sanitize user input, and use output encoding when rendering dynamic content.', 

                'created_at' => now(), 

                'updated_at' => now(), 

            ], 

            [ 

                'name' => 'Insecure Direct Object References (IDOR)', 

                'description' => 'An attack where an attacker can access unauthorized data by manipulating object references in the system.', 

                'severity' => 'High', 

                'is_fixed' => false, 

                'mitigation' => 'Implement proper access controls and validate user permissions before accessing sensitive data.', 

                'created_at' => now(), 

                'updated_at' => now(), 

            ], 

            [ 

                'name' => 'Security Misconfiguration', 

                'description' => 'Occurs when a system is not securely configured, allowing attackers to exploit vulnerabilities.', 

                'severity' => 'Medium', 

                'is_fixed' => false, 

                'mitigation' => 'Regularly audit and review system configurations, and apply the principle of least privilege.', 

                'created_at' => now(), 

                'updated_at' => now(), 

            ], 

            [ 

                'name' => 'Cross-Site Request Forgery (CSRF)', 

                'description' => 'An attack where a malicious website tricks a user\'s browser into performing actions on a website where the user is authenticated.', 

                'severity' => 'High', 

                'is_fixed' => true, 

                'mitigation' => 'Use anti-CSRF tokens and ensure state-changing requests require authentication and authorization.', 

                'created_at' => now(), 

                'updated_at' => now(), 

            ], 

            [ 

                'name' => 'Remote Code Execution (RCE)', 

                'description' => 'An attack where an attacker can execute code on a target system from a remote location.', 

                'severity' => 'Critical', 

                'is_fixed' => false, 

                'mitigation' => 'Update and patch software regularly, implement strong access controls, and use network firewalls.', 

                'created_at' => now(), 

                'updated_at' => now(), 

            ], 

            [ 

                'name' => 'Denial of Service (DoS)', 

                'description' => 'An attack that aims to make a system or network unavailable for its intended users.', 

                'severity' => 'High', 

                'is_fixed' => true, 

                'mitigation' => 'Implement rate limiting, use load balancing, and have DDoS protection mechanisms in place.', 

                'created_at' => now(), 

                'updated_at' => now(), 

            ], 

            [ 

                'name' => 'Command Injection', 

                'description' => 'An attack where an attacker can execute arbitrary commands on a host operating system.', 

                'severity' => 'Critical', 

                'is_fixed' => false, 

                'mitigation' => 'Validate and sanitize user input, implement proper command validation, and use parameterized commands.', 

                'created_at' => now(), 

                'updated_at' => now(), 

            ], 

            [ 

                'name' => 'Cross-Site Request Forgery (CSRF) - New Vulnerability', 

                'description' => 'An attack where a malicious website tricks a user\'s browser into performing unintended actions on a different website.', 

                'severity' => 'High', 

                'is_fixed' => false,  // This vulnerability is intentionally left unfixed for demonstration purposes. 

                'mitigation' => 'Use anti-CSRF tokens and ensure state-changing requests require authentication and authorization.', 

                'created_at' => now(), 

                'updated_at' => now(), 

            ], 

            [ 

                'name' => 'New Vulnerability 1', 

                'description' => 'Description for New Vulnerability 1', 

                'severity' => 'Medium', 

                'is_fixed' => false, 

                'mitigation' => 'Implement security controls specific to the nature of the vulnerability.', 

                'created_at' => now(), 

                'updated_at' => now(), 

            ], 

            [ 

                'name' => 'New Vulnerability 2', 

                'description' => 'Description for New Vulnerability 2', 

                'severity' => 'Low', 

                'is_fixed' => true, 

                'mitigation' => 'Update software and apply patches regularly to address the vulnerability.', 

                'created_at' => now(), 

                'updated_at' => now(), 

            ], 

            [ 

                'name' => 'New Vulnerability 3', 

                'description' => 'Description for New Vulnerability 3', 

                'severity' => 'Critical', 

                'is_fixed' => false, 

                'mitigation' => 'Isolate affected systems, apply emergency security measures, and perform thorough security audits.', 

                'created_at' => now(), 

                'updated_at' => now(), 

            ], 

            // Add more vulnerabilities as needed 

        ]; 

 

        foreach ($vulnerabilities as $vulnerability) { 

            Vulnerability::create($vulnerability); 

        } 

    } 

} 

 